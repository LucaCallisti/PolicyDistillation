Start training...
/home/l.callisti/Distillation/distillation/lib/python3.10/site-packages/numpy/_core/fromnumeric.py:3860: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/home/l.callisti/Distillation/distillation/lib/python3.10/site-packages/numpy/_core/_methods.py:145: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)
[1/2000] AvgRew: nan
/home/l.callisti/Distillation/distillation/lib/python3.10/site-packages/gymnasium/wrappers/rendering.py:283: UserWarning: [33mWARN: Overwriting existing videos at /home/l.callisti/Distillation_LunarLander/Final_pipeline/Results/CarRacing/PPO/Teacher/videos/PPO_CarRacing_Teacher folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)[0m
  logger.warn(
Finished with reward: -105.5, Reward per episode: [ -64.2 -130.2  -78.4 -123.7  -74.9  -72.9 -114.  -134.  -127.5 -135.1]
/home/l.callisti/Distillation/distillation/lib/python3.10/site-packages/numpy/_core/fromnumeric.py:3860: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/home/l.callisti/Distillation/distillation/lib/python3.10/site-packages/numpy/_core/_methods.py:145: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)
[2/2000] AvgRew: nan
[3/2000] AvgRew: -24.09
[4/2000] AvgRew: nan
[5/2000] AvgRew: -24.55
[6/2000] AvgRew: nan
[7/2000] AvgRew: -26.74
[8/2000] AvgRew: nan
> /home/l.callisti/Distillation_LunarLander/Final_pipeline/PPO.py(218)ppo_update()
-> assert torch.isclose(ratio, torch.tensor(1.0), atol=1e-2).all(), "Ratio not close to 1 at first update!"
tensor([1.0037, 0.9983, 0.9974, 1.0014, 1.0014, 1.0008, 1.0010, 0.9973, 1.0014,
        1.0000, 1.0012, 0.9998, 1.0018, 0.9993, 0.9973, 1.0017, 0.9999, 0.9995,
        0.9997, 1.0010, 0.9967, 0.9973, 0.9985, 0.9955, 0.9985, 0.9995, 0.9992,
        1.0006, 1.0021, 0.9968, 1.0016, 1.0006, 0.9978, 0.9998, 1.0017, 1.0002,
        1.0001, 1.0024, 0.9977, 1.0004, 1.0013, 1.0053, 1.0017, 0.9980, 1.0010,
        0.9953, 1.0024, 1.0016, 1.0002, 1.0019, 1.0007, 1.0021, 1.0024, 1.0018,
        0.9971, 1.0027, 0.9992, 0.9985, 0.9937, 1.0023, 1.0012, 0.9995, 0.9976,
        0.9972, 1.0004, 1.0003, 1.0000, 0.9994, 0.9983, 1.0019, 1.0018, 1.0003,
        1.0032, 0.9988, 0.9995, 1.0000, 1.0016, 1.0011, 1.0017, 0.9986, 1.0001,
        1.0000, 1.0013, 0.9993, 1.0009, 1.0139, 1.0010, 0.9873, 1.0006, 1.0010,
        0.9981, 0.9998, 1.0004, 1.0030, 1.0006, 1.0032, 1.0002, 0.9991, 1.0000,
        1.0003, 1.0001, 1.0007, 0.9994, 1.0013, 0.9995, 1.0002, 1.0003, 0.9970,
        1.0029, 0.9963, 0.9948, 0.9974, 0.9942, 1.0003, 0.9994, 1.0021, 1.0011,
        1.0004, 1.0030, 0.9996, 1.0006, 1.0010, 0.9994, 1.0006, 1.0020, 1.0020,
        0.9990, 1.0038, 1.0004, 1.0001, 0.9999, 0.9987, 0.9985, 0.9995, 1.0008,
        0.9995, 0.9988, 1.0009, 0.9995, 1.0017, 1.0017, 0.9996, 1.0010, 1.0006,
        0.9998, 1.0005, 1.0014, 1.0000, 1.0002, 1.0015, 0.9990, 0.9972, 0.9998,
        0.9965, 0.9991, 0.9985, 0.9975, 1.0013, 0.9981, 1.0018, 1.0001, 1.0024,
        0.9943, 1.0000, 0.9989, 0.9983, 0.9987, 0.9965, 1.0008, 1.0013, 0.9997,
        0.9996, 1.0004, 0.9994, 1.0002, 1.0002, 0.9994, 1.0008, 1.0012, 1.0030,
        0.9980, 0.9964, 1.0024, 1.0014, 0.9968, 1.0030, 0.9997, 1.0024, 0.9951,
        0.9994, 1.0031, 1.0014, 0.9997, 0.9973, 0.9998, 0.9998, 1.0015, 0.9996,
        1.0014, 1.0035, 1.0020, 1.0021, 0.9995, 0.9971, 1.0009, 1.0003, 0.9996,
        0.9991, 1.0009, 1.0002, 1.0001, 1.0013, 1.0012, 0.9970, 1.0010, 1.0000,
        1.0013, 1.0000, 0.9995, 1.0002, 0.9991, 1.0034, 0.9973, 0.9998, 0.9969,
        1.0102, 0.9999, 0.9961, 0.9986, 1.0021, 1.0003, 0.9992, 0.9999, 1.0001,
        1.0019, 0.9992, 1.0013, 0.9993, 0.9960, 0.9913, 1.0025, 1.0013, 0.9971,
        1.0000, 1.0029, 1.0006, 1.0001, 0.9988, 1.0014, 1.0003, 1.0000, 0.9992,
        0.9995, 0.9990, 1.0002, 0.9993], device='cuda:4',
       grad_fn=<ExpBackward0>)
tensor(0.0139, device='cuda:4', grad_fn=<MaxBackward1>)
tensor(0, device='cuda:4')
tensor(0, device='cuda:4')
tensor(253, device='cuda:4')
tensor(253, device='cuda:4')
torch.Size([256])
Traceback (most recent call last):
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/CarRacing.py", line 110, in <module>
    Train_teacher()
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/CarRacing.py", line 106, in Train_teacher
    PPO_trainer.train()
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/PPO.py", line 285, in train
    advantages, returns = self.compute_gae(next_value)
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/PPO.py", line 218, in ppo_update
    print(f"Warning: Ratio not close to 1 at first update! {(not torch.isclose(ratio, torch.tensor(1.0), atol=1e-2).sum().item())} elements differ. {torch.abs(ratio - 1.0).max().item()} max diff.")
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/PPO.py", line 218, in ppo_update
    print(f"Warning: Ratio not close to 1 at first update! {(not torch.isclose(ratio, torch.tensor(1.0), atol=1e-2).sum().item())} elements differ. {torch.abs(ratio - 1.0).max().item()} max diff.")
  File "/usr/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/usr/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
