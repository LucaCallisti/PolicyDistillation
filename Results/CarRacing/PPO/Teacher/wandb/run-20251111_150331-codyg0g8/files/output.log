Start training...
[1/1000] AvgRew: -26.71
/home/l.callisti/Distillation/distillation/lib/python3.10/site-packages/gymnasium/wrappers/rendering.py:283: UserWarning: [33mWARN: Overwriting existing videos at /home/l.callisti/Distillation_LunarLander/Final_pipeline/Results/CarRacing/PPO/Teacher/videos/PPO_CarRacing_Teacher folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)[0m
  logger.warn(
Finished with reward: -14.3, Reward per episode: [ 11.1 -30.7   7.5 -24.5   0.7   7.1 -13.9 -38.4 -27.8 -34.4]
> /home/l.callisti/Distillation_LunarLander/Final_pipeline/Models.py(175)get_action()
-> if self.deterministic:
tensor([[[[0.6361, 0.6868, 0.6868,  ..., 0.6269, 0.6269, 0.6269],
          [0.6476, 0.6868, 0.6868,  ..., 0.6269, 0.6269, 0.6269],
          [0.6591, 0.6868, 0.6868,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

         [[0.6315, 0.6868, 0.6868,  ..., 0.6269, 0.6269, 0.6269],
          [0.6453, 0.6868, 0.6868,  ..., 0.6269, 0.6269, 0.6269],
          [0.6568, 0.6868, 0.6868,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

         [[0.6292, 0.6868, 0.6868,  ..., 0.6269, 0.6269, 0.6269],
          [0.6407, 0.6868, 0.6868,  ..., 0.6269, 0.6269, 0.6269],
          [0.6522, 0.6868, 0.6868,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

         [[0.6292, 0.6845, 0.6868,  ..., 0.6269, 0.6269, 0.6269],
          [0.6384, 0.6868, 0.6868,  ..., 0.6269, 0.6269, 0.6269],
          [0.6522, 0.6868, 0.6868,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],


        [[[0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

         [[0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

         [[0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

         [[0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],


        [[[0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

         [[0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

         [[0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

         [[0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],


        ...,


        [[[0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

         [[0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

         [[0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

         [[0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],


        [[[0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

         [[0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

         [[0.6269, 0.6269, 0.6246,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

         [[0.6269, 0.6269, 0.6246,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],


        [[[0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

         [[0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

         [[0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

         [[0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          [0.6269, 0.6269, 0.6269,  ..., 0.6269, 0.6269, 0.6269],
          ...,
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]]],
       device='cuda:7')
tensor(0, device='cuda:7')
tensor([[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]], device='cuda:7', grad_fn=<AddmmBackward0>)
tensor([[nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        ...,
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan]], device='cuda:7',
       grad_fn=<ViewBackward0>)
Traceback (most recent call last):
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/CarRacing.py", line 110, in <module>
    Train_teacher()
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/CarRacing.py", line 106, in Train_teacher
    PPO_trainer.train()
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/PPO.py", line 279, in train
    input_ = self.next_obs.to(self.device)
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/PPO.py", line 208, in ppo_update
    _, newlogprob, entropy, newvalue = self.agent.get_action_and_value(
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/Models.py", line 207, in get_action_and_value
    action, log_prob, entropy = self.get_action(x, action)
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/Models.py", line 175, in get_action
    if self.deterministic:
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/Models.py", line 175, in get_action
    if self.deterministic:
  File "/usr/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/usr/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
