Start training...
Warning: Ratio not close to 1 at first update! elements differ. 0.01838505268096924 max diff.
Sanity check for NaNs in model parameters, iteration: 1
Sanity check - CNN params sum: 400.6163112649613
Sanity check - critic params sum: -20.875967293849953
Sanity check - actor_backbone params sum: 8.447970941662788
Sanity check - mu_layer params sum: 0.058175182435661554
Sanity check - log_std_param params sum: -2.164954073727131
[1/2000] AvgRew: nan
/home/l.callisti/Distillation/distillation/lib/python3.10/site-packages/gymnasium/wrappers/rendering.py:283: UserWarning: [33mWARN: Overwriting existing videos at /home/l.callisti/Distillation_LunarLander/Final_pipeline/Results/CarRacing/PPO/Teacher/videos/PPO_CarRacing_Teacher_BatchNorm folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)[0m
  logger.warn(
Finished with reward: -46.5, Reward per episode: [ -29.6  -43.9  -21.1  -49.6  -36.2 -123.9  -22.1  -58.9  -38.6  -41. ]
Warning: Ratio not close to 1 at first update! elements differ. 0.7570995092391968 max diff.
Sanity check for NaNs in model parameters, iteration: 2
Sanity check - CNN params sum: 342.97808779590196
Sanity check - critic params sum: -23.11768166764523
Sanity check - actor_backbone params sum: 4.573150850832462
Sanity check - mu_layer params sum: 0.14173900615423918
Sanity check - log_std_param params sum: -2.396721661090851
[2/2000] AvgRew: nan
Warning: Ratio not close to 1 at first update! elements differ. 1.4007930755615234 max diff.
Sanity check for NaNs in model parameters, iteration: 3
Sanity check - CNN params sum: 172.18764709942775
Sanity check - critic params sum: -25.49043978890404
Sanity check - actor_backbone params sum: 6.021170036867261
Sanity check - mu_layer params sum: 0.07851941557601094
Sanity check - log_std_param params sum: -2.517828017473221
[3/2000] AvgRew: -26.95
Warning: Ratio not close to 1 at first update! elements differ. 0.4801417589187622 max diff.
Sanity check for NaNs in model parameters, iteration: 4
Sanity check - CNN params sum: -5.566482419175941
Sanity check - critic params sum: -25.24526438047178
Sanity check - actor_backbone params sum: 4.265356861054897
Sanity check - mu_layer params sum: 0.010484847240149975
Sanity check - log_std_param params sum: -2.6858911514282227
[4/2000] AvgRew: nan
Warning: Ratio not close to 1 at first update! elements differ. 2.271042823791504 max diff.
Sanity check for NaNs in model parameters, iteration: 5
Sanity check - CNN params sum: -136.57778564692626
Sanity check - critic params sum: -24.458966942038387
Sanity check - actor_backbone params sum: 2.04703751206398
Sanity check - mu_layer params sum: 0.029796471819281578
Sanity check - log_std_param params sum: -2.8655319809913635
[5/2000] AvgRew: -26.37
Warning: Ratio not close to 1 at first update! elements differ. 1.2569754123687744 max diff.
Sanity check for NaNs in model parameters, iteration: 6
Sanity check - CNN params sum: -297.04345973632394
Sanity check - critic params sum: -22.969661129405722
Sanity check - actor_backbone params sum: 1.331551417708397
Sanity check - mu_layer params sum: -0.0832293126732111
Sanity check - log_std_param params sum: -2.881710708141327
[6/2000] AvgRew: nan
Warning: Ratio not close to 1 at first update! elements differ. 2.2879514694213867 max diff.
Sanity check for NaNs in model parameters, iteration: 7
Sanity check - CNN params sum: -373.0780516130228
Sanity check - critic params sum: -22.678801845759153
Sanity check - actor_backbone params sum: 2.1782386749982834
Sanity check - mu_layer params sum: -0.15262005757540464
Sanity check - log_std_param params sum: -3.009200930595398
[7/2000] AvgRew: -26.42
Warning: Ratio not close to 1 at first update! elements differ. 1.9438574314117432 max diff.
Sanity check for NaNs in model parameters, iteration: 8
Sanity check - CNN params sum: -524.7730300924754
Sanity check - critic params sum: -20.863471708260477
Sanity check - actor_backbone params sum: 0.5794146955013275
Sanity check - mu_layer params sum: -0.16961396299302578
Sanity check - log_std_param params sum: -3.0343079566955566
[8/2000] AvgRew: nan
Warning: Ratio not close to 1 at first update! elements differ. 2.241712808609009 max diff.
Sanity check for NaNs in model parameters, iteration: 9
Sanity check - CNN params sum: -510.07497311061525
Sanity check - critic params sum: -24.803149417042732
Sanity check - actor_backbone params sum: 3.07873672246933
Sanity check - mu_layer params sum: -0.08863000199198723
Sanity check - log_std_param params sum: -3.271390676498413
[9/2000] AvgRew: -23.71
Warning: Ratio not close to 1 at first update! elements differ. 7.582243919372559 max diff.
[iter 10] logratio non finito (min=-inf, max=2.14969539642334)
> /home/l.callisti/Distillation_LunarLander/Final_pipeline/PPO.py(241)ppo_update()
-> if not torch.isfinite(newvalue).all():
tensor([-0.8222,  0.4718,  0.1296,  0.1543, -0.5379,  0.0873, -0.1473, -0.2428,
        -0.0483, -0.7669,  0.0413,  0.0188,  0.1088, -0.0789, -0.0870,  0.0252,
        -0.3591,  0.1098, -0.1721,  0.0254,  0.0899, -0.0126, -0.5785,  0.1919,
         0.3146, -0.0802,  0.0768, -0.0951,  0.0613, -0.1139,  0.1650,  0.1503,
         0.1197,  0.0567,  0.1701,  0.2647,  0.1699,  0.2362, -0.0419,  0.0103,
        -0.5126,  0.0163,  0.0177,  0.0429, -0.1471, -0.1672,  0.2294, -0.1371,
         0.7484,  0.0923, -0.1373, -0.0847,  0.4994,  0.0724,  0.1139,  0.3539,
        -0.1856, -0.1876, -0.2313, -0.0719, -0.0302, -0.2856, -0.1029,  0.0705,
         0.0908, -0.1199,  0.1697, -0.0600, -0.1129,  0.0653,  0.0736,    -inf,
        -0.0457,  0.1378, -0.0383,  1.7112, -0.4580, -0.3238, -0.0455, -0.0291,
         0.0635,  0.0671,  0.3677, -0.5898,  0.2666, -0.2284, -0.4927, -0.0434,
        -0.0463,  0.0373,  0.1458, -0.0063,  0.1761, -0.1150, -0.1417, -0.0743,
        -0.2117,  0.1462, -0.4143, -0.2346,  0.2103,  0.1288,  0.1977, -0.1676,
         0.0121,  0.3781, -0.2529,  0.0286, -0.3220,  0.5367, -0.0449,  0.1200,
         0.0550,  0.0912, -0.0129, -0.0736,  0.0571,  0.2274, -0.2158,  0.1438,
         0.0537,  0.3293, -0.3710,  0.4229, -0.0295, -0.0650, -0.0694, -0.1374,
        -0.0088,  0.1233, -0.0308,  0.0084, -0.0690,  0.1266, -0.1909,  0.3098,
         0.3205,  0.1932, -0.1216,  0.1991, -0.0128,  0.0170,  0.0876,  0.5394,
         0.0290, -0.0158,  0.2858,  0.0561,  0.0143,  0.1283,  0.2367,  0.1841,
         0.1997,  0.3735, -0.4773,  0.6825, -0.2387, -0.0287,  0.0699, -0.3949,
         0.5062,  0.0576, -0.0882, -0.0243,  0.1513,  2.1497, -0.0579, -0.1244,
        -0.0651, -0.1276,  0.0695, -0.0704, -0.1049,  0.0385, -0.2133,  0.2287,
         0.2775, -0.2706,  0.0465, -0.2884, -0.1236,  0.3734, -0.0483,  0.1992,
         0.1729,  0.1276,  0.1639,  0.2341, -0.2330,  0.0643, -0.3320,  0.0747,
        -0.2849,  0.0671, -0.1690, -0.0248,  0.1275, -0.1303,  0.7730,  0.1871,
        -0.3685, -0.1428, -0.0443, -0.0850, -0.0284, -0.0426,  0.1918,  0.1659,
        -1.2422,  1.3046,  0.0267,  0.0112, -0.5367, -0.0502,  0.3249, -0.1431,
        -0.2135, -0.1106, -2.2619,  0.1712,  0.0099,  0.0428,  0.1405, -0.0721,
         0.0149,  0.0513, -0.0998, -0.1056, -0.4190,  0.0635,  0.0375, -0.2514,
        -0.0325,  0.2195, -0.0334, -0.3577, -0.0497, -0.1440, -0.2632,  0.2453,
        -0.0044, -0.1140, -0.1318, -0.0359,  0.3055,  0.0532,  0.0094,  0.1950,
        -0.0483, -1.5336,  0.1217, -0.2627, -0.1612,  0.1044,  0.0036, -0.0879],
       device='cuda:4', grad_fn=<SubBackward0>)
-inf
torch.Size([256])
2.14969539642334
tensor(-4.4995, device='cuda:4')
tensor(10.6314, device='cuda:4')
tensor(-inf, device='cuda:4', grad_fn=<MinBackward1>)
tensor(False, device='cuda:4')
tensor([3.7461, 4.5520, 4.0017, 3.2352, 3.2120, 3.2463, 2.0420, 5.2480, 4.4109,
        3.6973, 5.1060, 3.2415, 3.8554, 5.0187, 6.6273, 4.6512, 2.9906, 4.6760,
        4.2852, 2.9164, 4.2142, 4.5237, 6.2786, 3.9375, 3.2296, 4.1696, 5.0562,
        3.3143, 4.3490, 3.2816, 3.0803, 2.8284, 6.7843, 5.0619, 4.7041, 4.6216,
        4.7977, 3.8868, 3.8157, 4.2713, 3.0594, 4.9841, 5.3496, 6.0005, 3.5622,
        4.8052, 5.1994, 3.6913, 5.7627, 3.7922, 4.0617, 3.5926, 4.6325, 5.8775,
        3.1797, 2.7967, 3.6671, 4.1927, 4.9983, 6.2683, 5.3700, 2.8214, 3.7985,
        3.4502, 3.5772, 3.5208, 6.4508, 3.8334, 3.0133, 3.0696, 4.6353, 4.8939,
        3.7114, 4.0508, 3.8430, 5.6781, 5.9484, 2.4548, 4.1219, 3.5038, 3.0066,
        4.3301, 3.8602, 4.7750, 4.3899, 4.0616, 4.8893, 3.0988, 4.1707, 2.8333,
        4.1690, 2.7896, 4.9396, 3.2707, 3.7690, 4.6841, 6.5107, 3.2138, 4.1605,
        5.6467, 4.4718, 2.7334, 5.8931, 3.6908, 4.6071, 3.5071, 3.2868, 5.3735,
        4.9256, 5.2747, 6.5432, 4.4736, 5.4198, 4.2998, 2.6153, 3.6232, 5.7693,
        3.3210, 2.6355, 3.0472, 4.5636, 2.1216, 6.4039, 5.8638, 3.3288, 4.4649,
        3.9726, 4.9948, 3.1814, 6.0033, 4.2601, 3.7040, 5.8154, 3.4889, 5.9944,
        6.1364, 2.8186, 5.2348, 5.3878, 5.6341, 2.7754, 5.3625, 3.4596, 4.9832,
        2.6565, 3.5422, 3.9614, 4.4553, 4.0114, 4.8816, 3.3166, 2.2956, 3.5273,
        3.8910, 3.9452, 4.4522, 2.9227, 2.7747, 2.8536, 6.3129, 4.1375, 4.3628,
        4.2999, 2.6630, 2.7372, 4.0140, 3.9724, 3.7945, 3.3064, 3.2051, 2.4942,
        3.2590, 4.0831, 4.3898, 4.1750, 2.5687, 4.1547, 3.0634, 3.6482, 5.4954,
        4.9532, 3.3947, 3.9715, 4.7256, 3.5689, 6.4512, 4.1450, 5.0565, 5.5554,
        4.2338, 5.4299, 2.9618, 3.9094, 5.3359, 3.9894, 3.4389, 5.5318, 2.5062,
        3.0919, 3.0295, 3.5023, 5.9372, 2.7394, 5.4983, 3.4122, 4.0304, 3.6718,
        3.1829, 4.4032, 4.4046, 3.9896, 5.3218, 3.3040, 2.7947, 4.4410, 5.8651,
        2.9856, 5.4941, 3.3046, 5.0422, 3.1247, 3.5574, 5.3496, 4.5043, 4.9445,
        3.2188, 3.2690, 2.6978, 5.0226, 5.6430, 2.3407, 1.8893, 2.8607, 5.1943,
        4.6406, 3.2491, 4.9808, 3.9994, 4.8589, 3.8705, 5.8319, 2.7014, 4.3110,
        2.5717, 2.9178, 5.3554, 4.8417, 5.9629, 4.2671, 2.7045, 5.4952, 4.9151,
        3.2161, 5.9633, 4.1909, 2.5312], device='cuda:4',
       grad_fn=<SumBackward1>)
tensor(1.8893, device='cuda:4', grad_fn=<MinBackward1>)
tensor(6.7843, device='cuda:4', grad_fn=<MaxBackward1>)
Normal(loc: torch.Size([256, 3]), scale: torch.Size([256, 3]))
Traceback (most recent call last):
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/CarRacing.py", line 116, in <module>
    Train_teacher()
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/CarRacing.py", line 112, in Train_teacher
    PPO_trainer.train()
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/PPO.py", line 331, in train
    logs = self.ppo_update(advantages, returns)
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/PPO.py", line 241, in ppo_update
    if not torch.isfinite(newvalue).all():
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/PPO.py", line 241, in ppo_update
    if not torch.isfinite(newvalue).all():
  File "/usr/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/usr/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
