Start training...
[INFO] Number of trainable parameters: -19.06790542602539
[DEBUG] Number of trainable parameters: -19.06790542602539
[DEBUG] b_actions[mb_inds][:5]: tensor([[ 0.2557,  0.7203,  0.5781],
        [ 0.2584,  0.1528,  0.0765],
        [-0.1713,  0.5264,  0.9327],
        [ 0.3770,  0.6126,  0.1988],
        [ 0.2355,  0.6172,  0.5495]], device='cuda:7')
[DEBUG] b_logprobs[mb_inds][:5]: tensor([-1.0026, -3.4172, -2.7707, -1.4224, -0.8041], device='cuda:7')
[DEBUG] newlogprob[:5]: tensor([-inf, -inf, -inf, -inf, -inf], device='cuda:7',
       grad_fn=<SliceBackward0>)
[DEBUG] newlogprob has -inf: True
[DEBUG] newlogprob has NaN: False
[DEBUG] entropy[:5]: tensor([2.1774, 2.1774, 2.1774, 2.1774, 2.1774], device='cuda:7',
       grad_fn=<SliceBackward0>)
[DEBUG] entropy has -inf: False
[DEBUG] Actions with -inf logprob: tensor([[ 0.2557,  0.7203,  0.5781],
        [ 0.2584,  0.1528,  0.0765],
        [-0.1713,  0.5264,  0.9327],
        [ 0.3770,  0.6126,  0.1988],
        [ 0.2355,  0.6172,  0.5495],
        [-0.7395,  0.5764,  0.4768],
        [-0.3987,  0.3973,  0.4663],
        [-0.7381,  0.7087,  0.2930],
        [-0.3540,  0.6144,  0.6881],
        [-0.5365,  0.2910,  0.4340],
        [-0.6977,  0.5841,  0.3736],
        [-0.2238,  0.2077,  0.3030],
        [-0.5747,  0.2029,  0.6472],
        [-0.2650,  0.6525,  0.6900],
        [ 0.4744,  0.7854,  0.4598],
        [-0.0095,  0.2063,  0.3987],
        [-0.3029,  0.5392,  0.4285],
        [-0.2419,  0.5383,  0.2028],
        [ 0.1187,  0.9011,  0.5549],
        [ 0.3891,  0.6384,  0.4033],
        [-0.1823,  0.2180,  0.2807],
        [-0.0170,  0.1447,  0.1813],
        [-0.3744,  0.6170,  0.6671],
        [-0.0854,  0.2265,  0.1841],
        [-0.0782,  0.1633,  0.6713],
        [ 0.1926,  0.5328,  0.6901],
        [ 0.3443,  0.2741,  0.7463],
        [ 0.4729,  0.8781,  0.6615],
        [ 0.2361,  0.4727,  0.5990],
        [-0.4752,  0.3474,  0.3659],
        [ 0.5258,  0.6783,  0.4201],
        [-0.2968,  0.7060,  0.3872],
        [-0.5262,  0.5348,  0.5375],
        [-0.4092,  0.2819,  0.7600],
        [-0.1739,  0.1434,  0.7262],
        [-0.2439,  0.5824,  0.8173],
        [ 0.0971,  0.7104,  0.7211],
        [ 0.3072,  0.3636,  0.2668],
        [-0.5534,  0.6299,  0.6921],
        [-0.3604,  0.8775,  0.5877],
        [ 0.1280,  0.6122,  0.1000],
        [ 0.8744,  0.5121,  0.4239],
        [-0.6052,  0.3667,  0.4012],
        [ 0.5996,  0.2870,  0.2423],
        [-0.0384,  0.1385,  0.1852],
        [-0.0421,  0.7171,  0.4419],
        [ 0.2114,  0.4011,  0.2478],
        [ 0.3468,  0.6884,  0.3211],
        [-0.4467,  0.8912,  0.7244],
        [ 0.3265,  0.3193,  0.8146],
        [ 0.5391,  0.5183,  0.2661],
        [ 0.7704,  0.7847,  0.6553],
        [ 0.5976,  0.2132,  0.4943],
        [ 0.6782,  0.7771,  0.2280],
        [-0.4223,  0.3566,  0.4178],
        [ 0.6989,  0.6720,  0.4324],
        [ 0.1070,  0.4701,  0.5572],
        [ 0.2332,  0.7073,  0.3702],
        [ 0.4395,  0.4263,  0.3121],
        [ 0.5159,  0.1846,  0.6985],
        [-0.0680,  0.6308,  0.6441],
        [ 0.3746,  0.5329,  0.1814],
        [-0.7085,  0.6882,  0.7315],
        [ 0.4487,  0.5015,  0.5792],
        [-0.5975,  0.9142,  0.2934],
        [ 0.7789,  0.5528,  0.1216],
        [ 0.5095,  0.4348,  0.1142],
        [-0.2032,  0.2982,  0.6237],
        [-0.3823,  0.4916,  0.4103],
        [ 0.0234,  0.5666,  0.4401],
        [ 0.9160,  0.6263,  0.4079],
        [ 0.1466,  0.4922,  0.1419],
        [-0.6381,  0.2706,  0.4006],
        [ 0.2471,  0.1494,  0.4271],
        [-0.6474,  0.7136,  0.5055],
        [ 0.6077,  0.4176,  0.5388],
        [ 0.5044,  0.7272,  0.3225],
        [ 0.2833,  0.5151,  0.3589],
        [-0.1972,  0.7066,  0.5781],
        [-0.0929,  0.4254,  0.6711],
        [ 0.3257,  0.5915,  0.7438],
        [-0.2701,  0.5845,  0.7568],
        [ 0.0277,  0.7698,  0.5742],
        [-0.3803,  0.2043,  0.7456],
        [ 0.6889,  0.6222,  0.5422],
        [-0.6126,  0.1473,  0.5173],
        [ 0.0127,  0.5746,  0.2003],
        [ 0.8545,  0.2998,  0.6368],
        [-0.8345,  0.8663,  0.0852],
        [-0.0104,  0.1130,  0.5603],
        [-0.0276,  0.3919,  0.2335],
        [-0.2079,  0.6399,  0.2674],
        [-0.0519,  0.5791,  0.1126],
        [-0.7853,  0.1184,  0.4067],
        [ 0.5412,  0.2477,  0.7000],
        [ 0.3578,  0.4544,  0.2259],
        [-0.7852,  0.6217,  0.4583],
        [ 0.3260,  0.5791,  0.5908],
        [-0.5851,  0.7307,  0.9025],
        [-0.4535,  0.4337,  0.4947],
        [-0.9015,  0.4437,  0.4851],
        [-0.0679,  0.4058,  0.2819],
        [ 0.3038,  0.5095,  0.5665],
        [ 0.4467,  0.6056,  0.1802],
        [-0.5214,  0.2394,  0.3411],
        [-0.3757,  0.2808,  0.6055],
        [ 0.5272,  0.4927,  0.6000],
        [ 0.7587,  0.7516,  0.5860],
        [-0.2263,  0.0732,  0.4480],
        [-0.0110,  0.1152,  0.8076],
        [ 0.1243,  0.5592,  0.4959],
        [-0.3218,  0.2982,  0.2271],
        [-0.0635,  0.3062,  0.7713],
        [ 0.7002,  0.0622,  0.4661],
        [ 0.4579,  0.7380,  0.1139],
        [-0.3185,  0.7453,  0.5093],
        [-0.6646,  0.6857,  0.6305],
        [-0.3585,  0.5749,  0.4365],
        [-0.7319,  0.6622,  0.2947],
        [ 0.7249,  0.5778,  0.3682],
        [-0.4968,  0.1270,  0.5317],
        [-0.1449,  0.1857,  0.7842],
        [ 0.2873,  0.4308,  0.6535],
        [-0.2376,  0.4263,  0.4233],
        [-0.4745,  0.6040,  0.4888],
        [-0.0048,  0.8935,  0.5059],
        [ 0.7583,  0.6882,  0.0762],
        [-0.5128,  0.6122,  0.7788]], device='cuda:7')
> /home/l.callisti/Distillation_LunarLander/Final_pipeline/PPO.py(237)ppo_update()
-> assert torch.isclose(ratio, torch.tensor(1.0), atol=1e-4).all(), "Ratio not close to 1 at first update!"
tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], device='cuda:7',
       grad_fn=<ExpBackward0>)
torch.Size([1024, 16, 4, 96, 96])
torch.Size([4, 96, 96])
tensor([[-0.4829,  0.2068,  0.8443]], device='cuda:7', grad_fn=<AddBackward0>)
*** AttributeError: 'PPOTrainer' object has no attribute 'action'
tensor([0.4459, 0.5134, 0.3407], device='cuda:7')
Traceback (most recent call last):
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/CarRacing.py", line 110, in <module>
    Train_teacher()
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/CarRacing.py", line 106, in Train_teacher
    PPO_trainer.train()
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/PPO.py", line 304, in train
    advantages, returns = self.compute_gae(next_value)
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/PPO.py", line 237, in ppo_update
    breakpoint()
  File "/home/l.callisti/Distillation_LunarLander/Final_pipeline/PPO.py", line 237, in ppo_update
    breakpoint()
  File "/usr/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/usr/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
